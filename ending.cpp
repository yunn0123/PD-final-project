#include <iostream>
using namespace std;

#include "./headFile/ending.h"

// ??????????¡±??????????????¡Ó?
void Ending :: checkForEnding(Player& player)
{
     // ??????????????????????????????
    const int minVal = 0;
    const int maxVal = 50;

    // ????????¡Â????????¢X??????????????????
    if (isValuesBalanced(player, minVal, maxVal)) {
        restartEnding(player);
        return;
    }

    // const string mothershipModel = "?¡Â??????????";
    // const string trainModel = "????????????";
    // if (hasSpecificItem(player, mothershipModel) && hasSpecificItem(player, trainModel)) {
    //     hiddenEnding();
    //     return;
    // }

    bool hasAllItem = true;
    const bool* itemList = player.getItem();
    for(int i = 0; i < 4; i++){
        if(itemList[i] == 0){
            hasAllItem = false;
            break;
        }
    }
    if(hasAllItem){
        hiddenEnding();
        return;
    }


    //
}
// ????????????????????¡Â??????????????????
bool Ending :: isValuesBalanced(Player& player, int minVal, int maxVal)
{

    bool restartGame = false;

    if(player.value1 >= maxVal){
        cout << "===========================================================" << endl;
        cout << "????????¡P?¡Ó???????????¢X?????????????????????????????????¡P?????????????¢X?????¢X?????????????" << endl;
        cout << "===========================================================" << endl;
        restartGame = true;
    } else if(player.value1 <= minVal){
        cout << "===========================================" << endl;
        cout << "?¢X?????????????????????????????¢X??????????????????????????????????" << endl;
        cout << "===========================================" << endl;
        restartGame = true;
    } else if(player.value2 >= maxVal){
        cout << "===============================================================================================" << endl;
        cout << "????????¡Ó??????????????????????????¡P????????¡±????????¡P??¡Ó??????????????????????¢X???¡Â????????????????????????????????????????????????????¢X??¡Ó????" << endl;
        cout << "===============================================================================================" << endl;
        restartGame = true;
    } else if (player.value2 <= minVal){
        cout << "===============================================================================" << endl;
        cout << "?¡Â?????????????????????¡Â????¡P¡Â?????????????????????????????????????????????????????????????¢X???????????????????????¡P????" << endl;
        cout << "===============================================================================" << endl;
        restartGame = true;
    } else if(player.value3 >= maxVal){
        cout << "==============================================================================" << endl;
        cout << "????????????????????????????????????????????????????????????????????????????????????????????????????¢X?????¡±??¡Ó???????" << endl;
        cout << "==============================================================================" << endl;
        restartGame = true;
    } else if (player.value3 <= minVal){
        cout << "================================================================================" << endl;
        cout << "????????????????????????????????????????????????????????????????¢X¡Ó?????????????????????????????¢X?????????????????¡Ó??????" << endl;
        cout << "================================================================================" << endl;
        restartGame = true;
    } else if(player.value4 >= maxVal){
        cout << "======================================================================" << endl;
        cout << "?¡±???????????????????????????????????????????????????¢X???????????????????????????????????¢X???????????????" << endl;
        cout << "======================================================================" << endl;
        restartGame = true;
    } else if (player.value4 <= minVal){
        cout << "======================================================================" << endl;
        cout << "???????¡±?????????????????????????????¢X??????????????????????????????????????¡Ó????????????????????????????" << endl;
        cout << "======================================================================" << endl;
        restartGame = true;
    }
    return restartGame;
}

//????????¡Â?????????????????????
// bool Ending::hasSpecificItem(Player& player, const string itemName) {
//     for (const Item item : player.getItem()) {
//         if (item.getName() == itemName) {
//             return true;
//         }
//     }
//     return false;
// }

// ??????????¡Ó?
void Ending :: restartEnding(Player& player)
{
    cout << "?????????????????¢X????¡±?......." << endl;
    // ?????¢X????¡±???????????????????????¡±????????????????????????????
    player.restart = true;
    player.value1 = INI_VAL;
    player.value2 = INI_VAL;
    player.value3 = INI_VAL;
    player.value4 = INI_VAL;

}



// ??????????¡Ó?
void Ending :: normalEnding()
{
    cout << "?????????????¡P???????????¡Â????????????¢X????????¢X?????????????¡Â????????¡Ó??????????????????¢X?¡Ó??¡P¡Ó??????" << endl
        << "???????????????????????????????¡P¡Â????¡Ó???????????????????????????????????¡Â????????¡Ó??????????????????????????????????????????????????????????" << endl
        << "?????????????????¢X???????¡Ó???????????¡P¡Ó?????????????????????????????¡Â????????????????????¡Â????????????????????????" << endl
        << "????????????????????¢X?????????????????????????????????????????????????????????????????????????????????????????????" << endl
        << "????????????????????????????????¡Â????????¡P????¡Ó??????????????¡±????" << endl;

    // ????????¡Â???
    cout << "????????????????????????????????????????????????????????????????¡Â????????¡Ó????" << endl
        << "?????????" << PLAYER.value1 << endl
        << "?????????" << PLAYER.value2 << endl
        << "?????????" << PLAYER.value3 << endl
        << "???????????????" << PLAYER.value4 << endl;
}

void Ending :: hiddenEnding()
{
    cout << "???????????????????????????????¡Ó?????????????????¡Ó???????????¢X??????????????¡P????????????¡Â????????????????????????" << endl;
    cout << "????????¡±????¡P¡Ó???????¢X???????????????¡Ó??????????????¡P?????????????????????????????¡Â?????????????????????" << endl;
    cout << "??????????????¢X????¡Â?????????????????????????????¡±????????????????????????????????????????????¢X??????????????????????????????????????????????????¡±????" << endl;
    cout << "????????????????????????????????????????????????????????????????????¢X???" << endl;
    cout << "????????????????????????????????????????????????????????????????¡P???¡±???????¢X¡Ó???????¢X????????????¡Ó???????????????????¢X??????????????????????" << endl;
    cout << "????????????????????????????????¡Â????????????????????¡Â?????????????¡P¡Ó??????????????????????????????????????¢X??????????¡Ó???????" << endl;
    cout << "???????????????????????¡Â?????????????????????????????¡Â?????????????¢X?????????????????????????" << endl;

}


